{% extends 'base.html.twig' %}

{% block content %}
<!doctype html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{%  block title %}Accueil - {% block title_base %}{{ parent() }}{% endblock %}{% endblock %}</title>
    </style>
</head>
	{% block body %}
		<div class="mb-5">
			<h1 class="text-center color-blue-dark-shebam mb-3">Liste des plugins</h1>
			<hr>
			{% if is_granted('IS_AUTHENTICATED_FULLY') %}
				<div class="mb-5"></div>
			{% else %}
				<p class="text-center mb-4 mt-4">Connectes toi pour pouvoir gérer la liste des plugins !</p>
			{% endif %}		
			<div class="d-flex justify-content-center">
				<div class="col padding-mobile">
					{% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%}
					<table id="tablePopupPlugin" class="table mb-5" data-toggle="table" {% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%} data-use-row-attr-func="true" data-reorderable-rows="true" {% endif %}>
						<thead class="bg-grey-shebam color-white-shebam font-weight-bold">
							<tr>
								<th scope="col">Nom du plugin</th>
								<th scope="col">Lien</th>
								<th scope="col">Date d'achat</th>
								<th scope="col">Durée</th>
								<th scope="col">Prix</th>
								<th scope="col">Client</th>
								<th scope="col">Action</th>
							</tr>
						</thead>
						<tbody>
							<tr class="bg-white-shebam">
							{% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%}
								{% for plugin in plugin %}
								<td>{{plugin.name}}</td>
								<td><a href="{{plugin.link}}" target="new">{{plugin.link}}</a></td>
								<td>{{plugin.purchaseddate|date('d-m-Y')}}</td>
								<td>{{plugin.duration|date('d-m-Y')}}</td>
								<td>{{plugin.price}}</td>
								<td>{{plugin.customer}}</td>
								<td>
									<a href=""><i class="fas fa-cog"></i></a>
										|
									<a href="{{ path('delete_plugin_front', {"id": plugin.id}) }}" onclick="return confirm('Attention vous vous apprettez à supprimer une tâche P2')"><i class="fas fa-trash"></i></a>
								</td>
								{% endfor %}
							{% endif %}
							</tr>
						</tbody>
					</table>
					{% if is_granted('IS_AUTHENTICATED_FULLY') and is_granted('ROLE_ADMIN')%}

						<div class="btn-add-task-home-mobile">
							<p class="mt-3 text-center"><a class="btn-yellow-shebam" href="{{ path('task_list_add_admin') }}">Ajouter</a></p>
						</div>
					{% endif %}
				</div>
				{% else %}
				<p>no</p>
				{% endif %}
				<div class="col">

				</div>
			</div>

			<!-- POPUP -->
			<!-- Plugin -->

			<div class="btn-add-task-home">
				<p class="mt-3 text-center"><a class="btn-yellow-shebam" href="" data-toggle="modal" data-target="#exampleModalCenter">Ajouter</a></p>
			</div>

			<!-- Modal -->
			<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLongTitle">Ajout d'un plugin</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
						{{ form_start(form_plugin_add_front) }}
							<div class="form-group">
								{{ form_row(form_plugin_add_front.name) }}
								{{ form_row(form_plugin_add_front.link) }}
								{{ form_row(form_plugin_add_front.purchaseddate) }}
								{{ form_row(form_plugin_add_front.duration) }}
								{{ form_row(form_plugin_add_front.price) }}
								{{ form_row(form_plugin_add_front.customer) }}
							</div>
							<div class="form-group">
								{{ form_row(form_plugin_add_front.submit) }}
							</div>
						{{ form_end(form_plugin_add_front) }}
				</div>
				</div>
			</div>
			</div>

		</div>
	{% endblock %}
</html>
{%  endblock %}